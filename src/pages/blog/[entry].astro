---
import type { Props as SeoProps } from 'astro-seo'

import BlogArticle from '@/screens/blog/Article.astro'
import BlogLayout from '@/layouts/Blog.astro'

import { loadArticles, type Article } from '@/api/articles'
import { Site } from '@/site.config'

export interface Props {
  article: Article
}

export async function getStaticPaths() {
  const articlesRaw = await loadArticles()

  return articlesRaw.map((article) => ({
    params: { entry: article.slug },
    props: { article }
  }))
}

const { article } = Astro.props
const { title, description, createdAt, updatedAt } = article.frontmatter

const props: SeoProps = {
  title: [title, Site.title].join(' â€“ '),
  description,
  openGraph: {
    basic: {
      title,
      type: 'article',
      url: Site.url,
      image: Site.url + '/images/og-image.png'
    },
    image: {
      secureUrl: Site.url + '/images/og-image.png',
      type: 'image/png',
      width: 1280,
      height: 640,
      alt: 'Logotype'
    },
    article: {
      authors: ['Vladislav Mamon'],
      publishedTime: createdAt,
      modifiedTime: updatedAt
    }
  }
}
---

<BlogLayout {...props}>
  <BlogArticle article={article} />
</BlogLayout>
