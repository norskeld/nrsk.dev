---
import { loadArticles, loadProjects } from '@/api/content'
import { unslash } from '@/api/utils'

import { withSeoOptions } from '@/config'

import Introduction from '@/screens/index/Introduction.astro'
import Articles from '@/screens/index/Articles.astro'
import Projects from '@/screens/index/Projects.astro'

import Index from '@/layouts/Index.astro'

const props = withSeoOptions({
  // NOTE: Sitemap integration is kinda dumb and always generates an url with trailing slash.
  canonical: Astro.url.href
})

const articles = await loadArticles({ sort: 'desc' })
const projects = await loadProjects()
---

<Index {...props}>
  <Introduction />

  <Articles items={articles} />
  <Projects items={projects} />
</Index>
